<h1>Person list:</h1>
<a *ngIf="accountFacade.isAuthenticated$() | async" class="btn btn-primary" [routerLink]="['/persons/add']">Add</a>
<div *ngIf="!isLoading else loading" class="card my-4">
    <table class="table"> 
        <thead>
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Birthday</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Modify Date</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let person of personCollection |  paginate: { itemsPerPage: 10, currentPage: page }">
                <td>{{person.firstName | titlecase}}</td>
                <td>{{person.lastName | titlecase}}</td>
                <td>{{person.birthday | date:'dd.mm.yyyy'}}</td>
                <td>{{person.email}}</td>
                <td>{{person.phoneNumber}}</td>
                <td>{{person.modifyDate | date:'dd.mm.yyyy HH:MM'}}</td>
                <td *ngIf="accountFacade.isAuthenticated$() | async"><a class="btn btn-primary" [routerLink]="['/persons/edit', person.id]">Edit</a></td>
                <td *ngIf="accountFacade.isAuthenticated$() | async"><button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteConfirmModal" (click)="onDeleteClick(person.id)">Delete</button></td>
            </tr>
        </tbody>
    </table>
    <pagination-template #p="paginationApi" class="d-flex flex-row justify-content-center"
                     (pageChange)="handlePageChange($event)"
                     (pageBoundsCorrection)="personCollection">
      <div class="pagination-previous me-2" [class.disabled]="p.isFirstPage()">
          <a class="btn btn-primary" *ngIf="!p.isFirstPage()" (click)="p.previous()">Previes</a>
      </div>
      <div class="me-2" *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
          <a class="btn btn-primary" (click)="p.setCurrent(page.value)" *ngIf="p.getCurrent() !== page.value">
              <span>{{ page.label }}</span>
          </a>
          <div class="btn btn-secondary" *ngIf="p.getCurrent() === page.value">
              <span>{{ page.label }}</span>
          </div>
      </div>
      <div class="pagination-next" [class.disabled]="p.isLastPage()">
          <a class="btn btn-primary" *ngIf="!p.isLastPage()" (click)="p.next()">Next</a>
      </div>
    </pagination-template>
</div>

<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteConfirmModal">Confirm delete</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Are you sore about delete person?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">No</button>
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal" (click)="onModalClosed()">Yes</button>
      </div>
    </div>
  </div>
</div>

<ng-template #loading>
    <img style="z-index: 2;" src="assets/images/spinner.svg">
</ng-template>

